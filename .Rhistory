vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.4))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
legend("right", inset=-1, title="Iris Type", c("setosa"," versicolo","  virginica"), col=ncol)
adr=expand.grid(1:5,1:5)
par(bg = "white",xpad=TRUE,mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(xpad=TRUE,bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
par(xpad=TRUE)
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
par(xpd=TRUE)
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6),xpd=TRUE)
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.2,0), title="Iris Type", c("setosa"," versicolo","  virginica"), col=ncol)
legend("topright", inset=c(-0.2,0), title="Iris Type", c("setosa"," versicolo","  virginica"), col=ncol,cex=0.5)
legend("topright", inset=c(-0.1,0), title="Iris Type", c("setosa"," versicolo","  virginica"), col=ncol,cex=0.5)
legend("topright", inset=c(-0.12,0), title="Iris Type", c("setosa"," versicolo","  virginica"), col=ncol,cex=0.5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=ncol,cex=0.5)
ncol
legend("topright", inset=c(-0.12,0), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=vcol,cex=0.5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=vcol,cex=0.5)
vcol
legend("topright", inset=c(-0.12,0), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
legend("topright", inset=c(-0.12,0.5), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
legend("topright", inset=c(-0.12,-0.5), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
legend("topright", inset=c(-0.12,-0.3), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,35,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,-0.3), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,35,85),cex=0.5)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,85,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,85,85),cex=0.5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,85,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,85,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,85,85),cex=0.5)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa"," versicolo","  virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.6))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.45)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.5)
legend("topright", inset=c(-0.12,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.6)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.6)
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.6)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
library(FactoMineR)
require(FactoClass)
iris=data.frame(iris)
tiris=scale(iris[,1:4])
source("Kohonenprep.R")
source("Kohonennet.R")
base=matrix(rep(tiris,300),ncol=dim(tiris)[2], byrow=T)
prof=kohonenqualigo(25476,5,5,0.04,0.01,2.99,0.65,base,dim(base)[1])
m=kohonenqualiclass(prof,tiris,dim(tiris)[1])
irclust=cbind(iris,m)[order(m),]
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
ncol=seq(0,240,length.out=3);
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
vcol=hcl(vcol,120,85)
#hcl pour la couleur
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
prop.table(table(irclust[,5],irclust[,6]), 2)
table(irclust[,5],irclust[,6]), 2)
table(irclust[,5],irclust[,6])
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
library(FactoMineR)
require(FactoClass)
iris=data.frame(iris)
tiris=scale(iris[,1:4])
source("Kohonenprep.R")
source("Kohonennet.R")
base=matrix(rep(tiris,300),ncol=dim(tiris)[2], byrow=T)
prof=kohonenqualigo(25476,6,6,0.04,0.01,2.99,0.65,base,dim(base)[1])
m=kohonenqualiclass(prof,tiris,dim(tiris)[1])
irclust=cbind(iris,m)[order(m),]
# Plot le grid 5x5
adr=expand.grid(1:6,1:6)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
# Construire la palette de trois type
ncol=seq(0,240,length.out=3);
# Faire varier les couleurs en utilisant hcl
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
rvcol=hcl(vcol,120,85)
# Affecter les couleurs aux noeuds
for(i in 1:36){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 6,ny=6)
# Ajouter le legend dans la marge
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
adr=expand.grid(1:6,1:6)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 6), c(0, 6), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
# Construire la palette de trois type
ncol=seq(0,240,length.out=3);
# Faire varier les couleurs en utilisant hcl
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
rvcol=hcl(vcol,120,85)
# Affecter les couleurs aux noeuds
for(i in 1:36){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 6,ny=6)
# Ajouter le legend dans la marge
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
library(FactoMineR)
require(FactoClass)
iris=data.frame(iris)
tiris=scale(iris[,1:4])
source("Kohonenprep.R")
source("Kohonennet.R")
base=matrix(rep(tiris,300),ncol=dim(tiris)[2], byrow=T)
prof=kohonenqualigo(25476,5,5,0.04,0.01,2.99,0.65,base,dim(base)[1])
m=kohonenqualiclass(prof,tiris,dim(tiris)[1])
irclust=cbind(iris,m)[order(m),]
library(FactoClass)
data(BreedsDogs)
#setwd("D:/Profiles/XU/Desktop/breedsdog")
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
source("dataprep.R")
source("Kohonenprep.R")
source("Kohonennet.R")
matd=matrix(rep(burt.cor,2500),ncol=dim(burt.cor)[2], byrow=T)
prof=kohonenqualigo(17,5,5,0.1,0.01,2.99,0.65,matd[sample(nrow(matd)),],dim(matd)[1]) # Entrainement sur 20 000
m=kohonenqualiclass(prof,burt.cor,dim(burt.cor)[1])
source("plotcarte.R")
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
library(FactoMineR)
require(FactoClass)
iris=data.frame(iris)
tiris=scale(iris[,1:4])
source("Kohonenprep.R")
source("Kohonennet.R")
base=matrix(rep(tiris,300),ncol=dim(tiris)[2], byrow=T)
prof=kohonenqualigo(25476,5,5,0.04,0.01,2.99,0.65,base,dim(base)[1])
m=kohonenqualiclass(prof,tiris,dim(tiris)[1])
irclust=cbind(iris,m)[order(m),]
source("plotcarte1.R")
source("plotcarte1.R")
getwd()
this.dir <- dirname("parent.frame(2)$ofile")
setwd(this.dir)
getwd()
# Plot le grid 5x5
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
# Construire la palette de trois type
ncol=seq(0,240,length.out=3);
# Faire varier les couleurs en utilisant hcl
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
rvcol=hcl(vcol,120,85)
# Affecter les couleurs aux noeuds
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
# Ajouter le legend dans la marge
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
adr=expand.grid(1:5,1:5)
par(bg = "white",mai=c(0.2,0.2,0.6,0.8))
plot(c(0, 5), c(0, 5), xlab = "", ylab = "",axes=FALSE,xaxs="i",yaxs="i",main="Carte Kohonen")
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col ="white")
# Construire la palette de trois type
ncol=seq(0,240,length.out=3);
# Faire varier les couleurs en utilisant hcl
vcol=ncol%*%(prop.table(table(irclust[,5],irclust[,6]), 2))
vnames=c(as.numeric(colnames(vcol)))
rvcol=hcl(vcol,120,85)
for(i in 1:25){
if(i %in% vnames)
rect(adr[i,1]-1,adr[i,2]-1,adr[i,1],adr[i,2],col=vcol[which(vnames==i)],lwd=0)
}
grid(nx = 5,ny=5)
par(xpd=TRUE)
legend("topright", inset=c(-0.16,0.2), title="Iris Type", c("setosa","versicolo","virginica"), pch=15,col=hcl(ncol,120,85),cex=0.55)
